# ğŸ§  StegoTester AI - Training Module

> The Machine Learning Laboratory for **StegoTester v3.0**. This repository handles dataset generation, feature extraction, and model training for advanced steganography detection.

This project implements a **Hybrid Detection Engine** that combines mathematical rules with machine learning algorithms to detect modern steganographic attacks (LSB, DCT, Echo Hiding) in both images and audio.

ğŸ”— **Main Project:** [StegoTester - The Ultimate Steganography Tool](https://github.com/umitkrkmz/StegoTester)

---

## ğŸ¯ Objective

Traditional steganalysis tools often rely on a single detection method. However, different hiding techniques leave different fingerprints. This project aims to build a robust detection system by training on thousands of synthetic samples and leveraging a multi-stage analysis pipeline.

## ğŸ—ï¸ Architecture: "The Gatekeeper"

We developed a unique **Hybrid Cascade Architecture** to maximize accuracy and performance:

| Data Type | Detection Method | Why? | Accuracy |
| :--- | :--- | :--- | :--- |
| **ğŸ–¼ï¸ Image** | **Machine Learning (Random Forest)** | Effective at detecting complex patterns left by LSB, DCT, and Spread Spectrum attacks. | **~87%** |
| **ğŸµ Audio (LSB)** | **Mathematical Rule (Chi-Square)** | Serves as the "Gatekeeper". Detects statistical anomalies in bit transitions with near-perfect precision. | **~99.9%** |
| **ğŸµ Audio (Echo)** | **Machine Learning (Gradient Boosting)** | Detects subtle spectral changes (Echo Hiding) that mathematical rules might miss. | **~68%** |

### Workflow
1.  **Input Analysis:** The file enters the pipeline.
2.  **The Gatekeeper (Math):** For audio, it calculates the `LSB Transition Rate`. If it breaches the threshold (0.455), it flags the file as **STEGO** immediately. Zero AI latency.
3.  **The Detective (AI):** If the file passes the math check (or is an image), it is sent to the specific AI model for deep pattern analysis.

---

## ğŸ“‚ Project Structure

* `src/generators.py`: The factory. Generates thousands of stego-infected samples (LSB, DCT, Echo, SSIS).
* `src/extract_features.py`: Extracts statistical and spectral features using **Librosa** and **OpenCV**.
* `src/train_advanced.py`: The "Arena". Trains multiple models (RF, GBM, SVM, CNN) and automatically saves the best performer.
* `src/final_detector.py`: The master brain. Combines the trained models and math rules into a single detection function.
* `src/augment_images.py`: Augments the image dataset (Resize/Flip) for better model generalization.

---

## ğŸš€ Setup & Usage

### 1. Installation
Clone the repo and install dependencies (using a virtual environment is recommended):

```bash
git clone https://github.com/umitkrkmz/StegoTester-AI-Training.git
cd StegoTester-AI-Training
python -m venv venv
# Windows
venv\Scripts\activate
# Linux/Mac
source venv/bin/activate

pip install -r requirements.txt
```

### 2. Generate Your Own Dataset
If you want to train the models from scratch:

```Bash
# 1. Augment Data (Optional)
python src/augment_images.py

# 2. Generate Synthetic Stego Samples
python main_generator.py

# 3. Extract Features to CSV
python src/extract_features.py

# 4. Train & Save Best Models
python src/train_advanced.py
```

### 3. Run Detection
To analyze a suspicious file using the trained system:

```Bash
python src/final_detector.py
```
>(_Or import the `analyze_file` function into your own script_).

---

## ğŸ“Š Tech Stack
- Language: Python 3.11+

- ML Libraries: Scikit-Learn, TensorFlow (experimental CNN modules)

- Signal Processing: Librosa, SoundFile, SciPy

- Computer Vision: OpenCV (cv2)

- Data Handling: Pandas, NumPy

---

## ğŸ¤ Integration
The `.pkl` models generated by this repository are deployed in the main [StegoTester](https://github.com/umitkrkmz/StegoTester) application. This separation concerns allows the main app to remain lightweight while this repo handles the heavy lifting of training.
